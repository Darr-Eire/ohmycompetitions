// src/lib/pi/config.js
const PI_ENV = process.env.PI_ENV || 'sandbox';

const cfgByEnv = {
  sandbox: {
    appId: process.env.NEXT_PUBLIC_PI_APP_ID_SANDBOX,
    apiKey: process.env.PI_API_KEY_SANDBOX,
    baseUrl: process.env.PI_BASE_URL_SANDBOX || 'https://api.minepi.com',
    walletUrl: process.env.PI_WALLET_URL_SANDBOX || 'https://wallet.minepi.com',
    sandboxFlag: true,
  },
  testnet: {
    appId: process.env.NEXT_PUBLIC_PI_APP_ID_TESTNET,
    apiKey: process.env.PI_API_KEY_TESTNET,
    baseUrl: process.env.PI_BASE_URL_TESTNET || 'https://api.minepi.com',
    walletUrl: process.env.PI_WALLET_URL_TESTNET || 'https://wallet.testnet.minepi.com',
    sandboxFlag: false,
  },
  mainnet: {
    appId: process.env.NEXT_PUBLIC_PI_APP_ID_MAINNET,
    apiKey: process.env.PI_API_KEY_MAINNET,
    baseUrl: process.env.PI_BASE_URL_MAINNET || 'https://api.minepi.com',
    walletUrl: process.env.PI_WALLET_URL_MAINNET || 'https://wallet.minepi.com',
    sandboxFlag: false,
  }
};

export function piCfg() {
  const cfg = cfgByEnv[PI_ENV];
  if (!cfg?.appId || !cfg?.apiKey) {
    throw new Error(`[pi/config] Missing Pi credentials for PI_ENV=${PI_ENV}`);
  }
  return { ...cfg, env: PI_ENV };
}
