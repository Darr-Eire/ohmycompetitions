<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Pi App</title>

  <!-- Load Pi SDK -->
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>

  <script>
    Pi.init({
      version: "2.0",
      sandbox: true // ✅ Change to false for production
    });
  </script>
</head>
<body style="font-family: sans-serif; padding: 2rem; background-color: #111; color: #0f0;">
  <h1>Login to Pi</h1>
  <button id="pi-login" style="padding: 1rem; font-size: 1.2rem;">Log in with Pi</button>

  <!-- Where we'll show the token -->
  <pre id="output" style="margin-top: 2rem; white-space: pre-wrap;"></pre>

  <script>
    const Pi = window.Pi;
    const scopes = ['username', 'payments'];

    function onIncompletePaymentFound(payment) {
      document.getElementById('output').textContent = '⚠️ Incomplete payment found:\n' + JSON.stringify(payment, null, 2);
    }

    document.getElementById('pi-login').addEventListener('click', () => {
      Pi.authenticate(scopes, onIncompletePaymentFound)
        .then(({ accessToken, user }) => {
          document.getElementById('output').textContent =
            '✅ Logged in!\n\nAccess Token:\n' + accessToken + '\n\nUser:\n' + JSON.stringify(user, null, 2);
        })
        .catch(err => {
          document.getElementById('output').textContent = '❌ Login failed:\n' + err.message;
        });
    });
  </script>
</body>
</html>
